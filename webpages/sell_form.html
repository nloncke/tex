{% extends "base_topsearch.html" %}
{% block header %}
<link href="/static/bootstrap-datetimepicker.min.css" rel="stylesheet">
<script type="text/javascript" src="/static/moment.min.js"></script>
<script type="text/javascript" src="/static/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript">
$(function () {
    $('#datetimepicker').datetimepicker({
        sideBySide: true,
        minDate: moment().subtract('days', 1),
        sideBySide: true,
    });
});

$(function () {
  	$("#datetimepicker").on('dp.hide', function(){
		if(moment().isAfter(moment(
			$("#end_time").val(), "MM/DD/YY HH:mm"))){
			alert("Please select a time in the future");
			$("#submit").attr("disabled", "disabled");
		}
		else {
			$("#submit").removeAttr("disabled");
			}
	});
});

$(function () {
	$("#is_auction").click(function () {
		if ($("#is_auction").is(':checked')) {
			$(".auction").toggle();
			$("#end_time").attr('required',true);
			$("#current_price").attr('required',true);
			$("#is_auction").val("yes");
			
		}
		else {
			$(".auction").toggle();
			$("#end_time").attr('required',false);
			$("#current_price").attr('required',false);
		}		
	});
});
</script>

<script type="text/javascript">
$(function () {
	$("#sell_form").validate({
		rules: {
			current_price: {
				depends: function(element) {
					return $("#is_auction:checked")
				}

			}
			price: {
				min: current_price
			},
		}
	});
}
</script>

{% endblock header %}

{% block content %}
<div class="center-page center-all">

{% if book %}
<!-- DISPLAY THE BOOK -->
<div class="media center-all">
	<div style="padding-left:15%">
		<img class="media-object pull-left" src="{{book.frontcover}}" alt="{{book.title}}" height="211px" width="171px">
		<div class="media-body book-info" style="text-align:left">
			<h3 class="media-heading" style="font-size:28px"><strong>{{book.title}}</strong></h3>
	    	<h2 style="font-size:20px">
	         	<p>Author(s): {{book.author}}</p>
	         	<p>ISBN-13: {{book.isbn}}</p>
	         	<p>Published Date: {{book.pub_date}}</p>
	        </h2>
	    </div>
	</div>
</div>
<!-- END BOOK DISPLAY -->

<!-- sell form -->

<form id="sell_form" action="/sell/submit/" class="form-horizontal" role="form" method="post"> {% csrf_token %}
	<input type="hidden" id="target_isbn" name="target_isbn" value="{{book.isbn}}">
	<h1 style="font-size:16px">
		<div class="form-group" style="padding-left:30%">
			<label for="course" class="col-sm-2 control-label">Course:</label>
			<div class="col-sm-10">
				<input id="course" name="course" class="form-control" style="width:150px" type="text" required pattern="(^[a-zA-Z]{3}( )*[0-9]{3}$)" title="Enter a valid course name e.g COS 333" placeholder="e.g COS 333">
			</div>
		</div>
		<div class="form-group" style="padding-left:30%">
			<label for="is_auction" class="col-sm-2 control-label">Auction:</label>
			<div class="col-sm-10">
				<input id="is_auction" name="is_auction" class="checkbox" type="checkbox"/>
			</div>
		</div>		
		<div class="form-group collapse auction" style="padding-left:30%">
			<label for="end_time" class="col-sm-2 control-label">End Date:</label>		
            <div class='col-sm-2 input-group date' id='datetimepicker' data-date-format="MM/DD/YY HH:mm">
                <input type='text' id="end_time" name="end_time" class="form-control" style="width:150px" title="Please select a date and time."/>
                <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span>
                </span>   
	     	</div>
	    </div>
		<div class="form-group collapse auction" style="padding-left:30%">
			<label for="current_price" class="col-sm-2 control-label">Start Price ($):</label>		
			<div class="col-sm-10">
				<input id="current_price" name="current_price" class="form-control" style="width:150px" type="text"
				 pattern="(^[1-9]$)|(^[1-9]\d$)|(^[1-9]\d\d$)" title="Whole numbers only; dollar sign not required" placeholder="e.g 10"/>
			</div>
		</div>		
		<div class="form-group" style="padding-left:30%">
			<div class="input-append collapse auction"><label for="price" class="col-sm-2 control-label">Buy Now <br> Price ($):</label>
			</div>
			<div class="input-append auction"><label for="price" class="col-sm-2 control-label">Price ($):</label>
			</div>
			<div class="col-sm-10">
				<input id="price" name="price" class="form-control" type="text" style="width:150px"
				required pattern="(^[1-9]$)|(^[1-9]\d$)|(^[1-9]\d\d$)" title="Whole numbers only; dollar sign not required" placeholder="e.g 25"/>
				
			</div>
		</div>	
		<div class="input-append collapse auction"><span inline class="help-block">Book is sold if someone bids this price.</span>
		</div>
		<div class="form-group ">
			<label for="condition" class="col-sm-2 control-label" style="padding-left:20%">Condition:</label>
			<label for="new" class="radio-inline"><input required id="new" name="picked_condition" type="radio" value="New"/>New</label>
			<label for="like_new" class="radio-inline"><input required id="like_new" name="picked_condition" type="radio" value="Like New"/>Like New</label>
			<label for="very_good" class="radio-inline"><input required id="very_good" name="picked_condition" type="radio" value="Very Good"/>Very Good</label>
			<label for="good" class="radio-inline"><input required id="good" name="picked_condition" type="radio" value="Good"}/> Good</label>
			<label for="acceptable" class="radio-inline"><input required id="acceptable" name="picked_condition" type="radio" value="Acceptable"/>Acceptable</label>
		</div>
		<div class="form-group" style="padding-left:30%">
			<label for="description" class="col-sm-2 control-label">Description:</label>
			<div class="col-sm-10">
				<textarea required maxlength="100" cols="40" id="description" class="form-control" style="width:250px"
				name="description" rows="5" title="Enter a short description about your book."></textarea>
			</div>
		</div>
    <button type="submit" id="submit" class="btn btn-default">
    	<span><strong>SELL</strong></span>
	</button>
    </h1>
</form>

{% endif %}
</div>
{% endblock content %}
